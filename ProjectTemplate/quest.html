<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" href="style1.css">
<link rel="stylesheet" href="style2.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<script>
    var userRole;
    
    function getCurrentRole(){
      var webMethod = "ProjectServices.asmx/LoadCurrentRole";
      var parameters = "{}";

      //jQuery ajax method
      $.ajax({
        type: "POST",
        url: webMethod,
        data: parameters,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
          if (msg.d) {
            userRole = msg.d;
            console.log(userRole);
            console.log("call function");
            getQuestMemberData();
          }
          else {
            alert("load current role failed");
          }
        },
        error: function (e) {
          alert("load current role boo...");
        }
      });
    }

    function getQuestMemberData(){
      
      var membersArray;
      var interests;

      console.log("loading quest member data...");

      webMethod = "ProjectServices.asmx/getQuestMembers";
      parameters = "{\"role\":\"" + encodeURI(userRole) + "\"}";

      $.ajax({
        type: "POST",
        url: webMethod,
        data: parameters,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
          if (msg.d.length > 0) {
            membersArray = msg.d;

            for (var i = 0; i < 1; i++){
              console.log(membersArray[i]);

              if (membersArray[i].python == true){
                interests = "Python";
              } else if (membersArray[i].java == true){
                interests += "Java";
              } else if (membersArray[i].sql == true){
                interests += "SQL";
              }
              
              document.getElementById("memberInfo").innerHTML = `${membersArray[i].fname} ${membersArray[i].lname}, ${membersArray[i].company}, ${membersArray[i].position}, ${membersArray[i].years}`;

              // document.getElementById('userName').innerHTML = profilesArray[i].fname + " " + profilesArray[i].lname;
              // document.getElementById('userYears').innerHTML = profilesArray[i].years;
              // document.getElementById('userCompany').innerHTML = profilesArray[i].company;
              // document.getElementById('userPosition').innerHTML = profilesArray[i].position;
              // document.getElementById('userBio').innerHTML = profilesArray[i].bio;
              // document.getElementById('area').innerHTML = interests;
            
          };
             getCourseData();
        } else {
            alert('loading failed');
          }
        },
        error: function (e) {
          alert("boo...");
        }
      });

    }

    function getCourseData() {
      var questsArray;

      console.log("loading quest data...");

      webMethod = "ProjectServices.asmx/getQuests";

      $.ajax({
        type: "POST",
        url: webMethod,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
          if (msg.d.length > 0) {
            questsArray = msg.d;

            for (var i = 0; i < 1; i++){
              console.log(questsArray[i]);

              document.getElementById("class").innerHTML = questsArray[i].courseName;
            }
          } else {
            alert('loading failed');
          }
        },
        error: function (e) {
          alert("boo...");
        }
      });
    }

</script>
<div class="w3-top">
	<div class="w3-bar w3-theme-d2 w3-left-align w3-large">
	 <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-theme-d2" href="javascript:void(0);" onclick="openNav()"><i class="fa fa-bars"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large w3-theme-d4"><i class="fa fa-home w3-margin-right"></i>Logo</a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="News"><i class="fa fa-globe"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="Account Settings"><i class="fa fa-user"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="Messages"><i class="fa fa-envelope"></i></a>
	 <div class="w3-dropdown-hover w3-hide-small">
	   <button class="w3-button w3-padding-large" title="Notifications"><i class="fa fa-bell"></i><span class="w3-badge w3-right w3-small w3-green">3</span></button>     
	   <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
		 <a href="#" class="w3-bar-item w3-button">One new friend request</a>
		 <a href="#" class="w3-bar-item w3-button">John Doe posted on your wall</a>
		 <a href="#" class="w3-bar-item w3-button">Jane likes your post</a>
	   </div>
	 </div>
	</div>
   </div>
   
   <!-- Navbar on small screens -->
   <div id="navDemo" class="w3-bar-block w3-theme-d2 w3-hide w3-hide-large w3-hide-medium w3-large">
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 1</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 2</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 3</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">My Profile</a>
   </div>

<body onload="getCurrentRole()" class="w3-theme-l5">
  <div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">
  <div class="w3-card w3-round w3-white w3-margin w3-padding-large">
  <h1>Quests</h1>
    
    <div id="mentorList">
      <div>
          <span id="memberInfo"></span>
            <ul id="class"><button>Enroll</button></ul>

        </div>
        
        <div>
          <span>Jane Don, Microsoft, Data Analytics Manager, 15 Years</span>
            <ul>Course 1 <button>Enroll</button></ul>
            <ul>Course 2 <button>Enroll</button></ul>
            <ul>Course 3 <button>Enroll</button></ul>
        </div>
    
    </div>

</body>
</html>