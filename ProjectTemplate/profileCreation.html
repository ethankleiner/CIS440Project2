<!-- come to this page after initial request account, and potentially to update profile -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your Profile</title>
	<link rel="stylesheet" href="style1.css">
	<link rel="stylesheet" href="style2.css">
	<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- script - need to redirect to profile pic upload page -->
    <script>
		var accountsArray;
		var noRepeatedAccount;

		//resets the new account inputs
		function clearProfile() {
			$('#profileFname').val("");
			$('#profileLname').val("");
			$('#profileBday').val();
			$('#profilePhone').val();
            $('#profileCompany').val("");
			$('#profilePosition').val("");
            $('#pythonCheck').checked = false;
            $('#javaCheck').checked = false;
            $('#sqlCheck').checked = false;
			$('#profileBio').val("");
            $('#profileYears').val();
		}

		//passes account info to the server, to create an account request
		function CreateProfile(fname, lname, bday, phone, comp, pos, years, python=null, java=null, sql=null, bio) {

			var ele = document.getElementsByName('role');
			var role = "";

			for (i = 0; i < ele.length; i++) {
				if (ele[i].checked)
					role = ele[i].value;
			}

            // new webMethod?
			var webMethod = "ProjectServices.asmx/StoreAccounts";
			$.ajax({
				type: "POST",
				url: webMethod,
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function (msg) {
					if (msg.d.length > 0) {
						accountsArray = msg.d;
						noRepeatedAccount = false;

						for (var i = 0; i < accountsArray.length; i++) {
							if (accountsArray[i].email == email) {
								noRepeatedAccount = false;
								break;
							} else {
								noRepeatedAccount = true;
							}
						}
					} else {
						alert("loading accounts failed");
					}
					console.log(noRepeatedAccount);

					if (noRepeatedAccount) {
                        // new webMethod?
						webMethod = "ProjectServices.asmx/RequestAccount";
						parameters = "{\"fname\":\"" + encodeURI(fname) + "\",\"lname\":\"" + encodeURI(lname) +
                        // + "\",\"bday\":\"" + encodeURI(bday) - not in table yet 
                        + "\",\"phone\":\"" + encodeURI(phone)+ "\",\"company\":\"" + encodeURI(company) 
                        + "\",\"experienceYears\":\"" + encodeURI(years) + "\",\"positionRole\":\"" + encodeURI(positionRole) + "\"}";

                        // need to add after updating table:
                        // + "\",\"bio\":\"" + encodeURI(bio) 
                        // + "\",\"python\":\"" + encodeURI(python) + "\",\"java\":\"" + encodeURI(java) + "\",\"sql\":\"" + encodeURI(sql) +

						$.ajax({
							type: "POST",
							url: webMethod,
							data: parameters,
							contentType: "application/json; charset=utf-8",
							dataType: "json",
							success: function (msg) {
								window.open('profilePictureUpload.html', '_self')
								clearProfile();
								alert("Profile updated!");
							},
							error: function (e) {
								console.log('profileUpdate failed')
								alert("boo...");
							}
						})
					} else {
						alert('Account ID exists! Choose a new one.');
						clearProfile();
					};
				},
				error: function (e) {
					console.log('stored Account failed')
					alert("boo...");
				}
			})
		};

	</script>
</head>

<!-- Navbar -->
<div class="w3-top">
	<div class="w3-bar w3-theme-d2 w3-left-align w3-large">
	 <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-theme-d2" href="javascript:void(0);" onclick="openNav()"><i class="fa fa-bars"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large w3-theme-d4"><i class="fa fa-home w3-margin-right"></i>Logo</a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="News"><i class="fa fa-globe"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="Account Settings"><i class="fa fa-user"></i></a>
	 <a href="#" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white" title="Messages"><i class="fa fa-envelope"></i></a>
	 <div class="w3-dropdown-hover w3-hide-small">
	   <button class="w3-button w3-padding-large" title="Notifications"><i class="fa fa-bell"></i><span class="w3-badge w3-right w3-small w3-green">3</span></button>     
	   <div class="w3-dropdown-content w3-card-4 w3-bar-block" style="width:300px">
		 <a href="#" class="w3-bar-item w3-button">One new friend request</a>
		 <a href="#" class="w3-bar-item w3-button">John Doe posted on your wall</a>
		 <a href="#" class="w3-bar-item w3-button">Jane likes your post</a>
	   </div>
	 </div>
	</div>
   </div>
   
   <!-- Navbar on small screens -->
   <div id="navDemo" class="w3-bar-block w3-theme-d2 w3-hide w3-hide-large w3-hide-medium w3-large">
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 1</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 2</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">Link 3</a>
	 <a href="#" class="w3-bar-item w3-button w3-padding-large">My Profile</a>
   </div>

<body class="w3-theme-l5">
	<div class="w3-container w3-content" style="max-width:1400px;margin-top:80px">
    <div class="w3-card w3-round w3-white w3-margin w3-padding-large">
	<h1>Profile Settings</h1>
    <form>
        <section>
            <label>First Name</label><br />
            <input type="text" class="textInput" id="profileFname" name="fName" required /><br /><br />
        </section>

        <section>
            <label>Last Name</label><br />
            <input type="text" class="textInput" id="profileLname" name="lName" required /><br /><br />
        </section>

        <section>
            <label>Birthday</label><br>
            <input type="date" id="profileBday" name="bday" required><br><br>
        </section>

        <section>
            <label>Phone Number (format: 123-456-7890)</label><br />
            <input type="tel" class="textInput" id="profilePhone" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" name="phone"
                required /><br /><br />
        </section>

        <section>
            <label>Company</label><br />
            <input type="text" type="text" class="textInput" id="profileCompany" name="company" required /><br /><br />
        </section>

        <section>
            <label>Position</label><br />
            <input type="text" class="textInput" id="profilePosition" required /><br /><br />
        </section>

        <section>
            <label>Years Experience</label><br />
            <input type="number" step="1" min="0" max="70" id="profileYears" required /><br /><br />
        </section>


        <section id="skillListSection">
            <span id="skillPrompt">Relevant Interests</span><br>
            <input value="1" id="pythonCheck" type="checkbox">
            <label id="pythonLabel" for="pythonCheck">Python</label><br>
            <input value="2" id="javaCheck" type="checkbox">
            <label id="javaLabel" for="javaCheck">Java</label><br>
            <input value="3" id="sqlCheck" type="checkbox">
            <label id="sqlLabel" for="sqlCheck">SQL</label><br>
        </section><br>


        <section id="bio">
            <label>Profile Bio</label><br />
            <input type="text" class="textInput" id="profileBio" name="bio" required /><br /><br />
        </section>

        <section id="buttons">
            <button type="reset" class="button" id="profileClear" value="Clear">Clear</button>
            <button type="submit" onclick="createProfile">Next</button>
        </section>

    </form>
	</div>
	</div>
	<br>
<!-- Footer -->
<footer class="w3-container w3-theme-d3 w3-padding-16">
	<h5>Footer</h5>
  </footer>
  
  <footer class="w3-container w3-theme-d5">
	<p><sup>&copy;</sup>Figrin D'an and the Modal Nodes</p>
  </footer>

</body>

</html>